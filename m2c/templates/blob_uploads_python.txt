#!/bin/bash

# Bash shell script to upload mongoexport blobs to Azure Storage with Python3.
#
# Database Name: {{ dbname }}
# Generated on:  {{ gen_timestamp }}
# Generated by:  {{ gen_by }}
# Template:      blob_uploads_python.txt

source env.sh

# Uncomment, as necessary, to delete and recreate the storage container:
# python storage.py delete_blob_container {{ container }}
# sleep 10
# python storage.py create_blob_container {{ container }}
# sleep 10

{% for c in collections %}
echo '---'
date
python storage.py upload_blob {{ c['local_file_path'] }} {{ container }} {{ c['blob_name'] }}
{% endfor %}

date

echo ''
echo 'listing contents of container: {{ container }}'
python storage.py list_blob_container {{ container }}

echo 'done'
